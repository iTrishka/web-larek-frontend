# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Архитектура

В проекте используется шаблон проектирования MVP.
Так как наше приложение небольшое, представление(Presenter) будет реализован в index.ts

### Описание данных 

1) **Карточка товара**  
```
interface IProductCard {
  id: string;
  title: string;
  description: string;
  image: string;
  category: string;
  price: number | null;
};
```
 

2) **Варианты оплаты заказа**  
```
type IPaymenOption  = 'cash' | 'card';
```
Имеет 2 варианта оплаты: 'cash' или 'card'.

3) **Данные покупателя**  
```
interface IProfile {
  payment: IPaymenOption;
  address: string;
  phone: string;
  email: string;
}
```
Используется при оформлении заказа и отправке серверу данных о заказе. 

4) **Элемент галереи**  
```
type ICatalogItem = Omit<IProductCard, 'description'>;
```
Представляет собой Карточку товара (interface IProductCard) без свойства 'description".
Используется в галереи товаров на главной странице.

5) **Корзина**  
```
type ICart= {
  item: Pick<IProductCard, 'id' | 'title' | 'price'>[]
  total: number
};
```
Состоит из массива выбранных товаров(укороченная версия interface IProductCard - 'id' | 'title' | 'price'), итоговой суммы заказа (число). 

6) **Заказ**  
```
IProfile & {
  total: number;
  items: string[]
};
```
Данный интерфейс используется в POST запросе при оформлении заказа

7) **Главная страница**  
```
interface IPage {
  amountItems: number;
  catalog: ICatalogItem;
  loading: boolean
}
```
Состоит из массива карточек товара (type ICatalogItem), количества товаров в корзине и статуса загрузки страницы.


### Слой Модели данных
1. **Класс Page**  
Реализует интерфейс IPage.  
Методы класса:  
   * *set catalog* - добавить карточки в каталог;
   * *get catalog* - получить карточки каталога;  
   * *set loading* - задать статус загрузки;
   * *get loading* - получить статус загрузки;
   * *set iconCart* - задать числа на иконке корзины;  
   * *get iconCart* - получить число на иконке корзины;

2. **Класс Cart**  
Реализует интерфейс ICart.   
Методы класса:  
   * *set cartItems* - обновить карточки в корзине;  
   * *get cart* - получить карзину;  
   * *countTotalPrice* - посчитать обсую стоимость заказа;  

3. **Класс Order**  
Реализует интерфейс IOrder  
Методы класса:
   * *set order* - создание заказа;   
   * *get order* - получить заказ;    

### Слой Presenter 
1. **Класс Api**  
Класc для работы с api.  
Методы класса:
   * *handleResponse* - обработка ответа с сервера;
   * *get* - выполнение GET запроса;
   * *post* - выполнение POST запроса;

2. **Класс EventEmitter**  
Реализует паттерн «Наблюдатель» и позволяет подписываться на события и уведомлять подписчиков о наступлении события.   
Методы класса:
   * *on ,  off ,  emit*  — для подписки на событие, отписки от события и уведомления подписчиков о наступлении события соответственно. 
   * *onAll и  offAll*  — для подписки на все события и сброса всех подписчиков.
   * *trigger* -  генерирующий заданное событие с заданными аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти классы будут генерировать события, не будучи при этом напрямую зависимыми от класса  EventEmitter .

3. **Класс App**  
Класc для работы  c событиями приложения:
   * *page:loading* - статус загрузки карточек с API;  
   * *items:add* - добавление карточек в каталог;  
   * *cart:onchanges* - обновление числа на иконке корзины; 
   * *cart:add-card* - добавление карточки в корзину;  
   * *cart:delete-card* - удаление карточки из корзины;  
   * *cart:clear* - очистить корзину;  
    * *order:create* - создание заказа;   
    * *order:send* - отправка заказа; 

### Слой View  - Компоненты представления

#### Базовые классы
1. **Класс Component**  
Абстрактный базовый класс для компонентов, который содержит инструментарий для работы с DOM в дочерних компонентах.
Аргументом конструктора служит HTMLElement.  
Методы класса:
   * *toggleClass* - переключение класса;
   * *setText* - установка текстового содержимого;
   * *setHidden, setVisible* - скрыть/показать элемент.

2. **Класс Model**  
Базовая модель, чтобы можно было отличить ее от простых объектов с данными.

3. **Класс Popup**  
Универсальный класс для работы с модальными окнами. 
Конструктор принимает в качестве аргумента селектор интересующего нас модального окна.  
Методы класса:
 	 * *open, close* - открытие и закрытие модального окна.

4. **Класс Form**  
Универсальный класс для работы с формами.
Принимает в конструкторе селектор конкретной формы.  
Методы класса:
   * *onInputChange* - отслеживает изменения в форме

#### Основные классы

1. **Класс PageUI**  
Выводит в контейнере галерею товаров и работает со счетчиком корзины.  
Методы класса:
   * *set catalog* - отрисовка карточек товара.
   * *set amountItems* - установка цифры в счетчике товаров на иконке корзины.  
   * *toggleSpinner* - отрисовка спинера  

2. **Класс CatalogItemUI**  
Элемент галереи (класс Catalog).
Содержит элементы товара интерфейса ICatalogItem
При клике на карточку генерируется событие ui:open-card. Открывается модальное окно с подробной информацией о товаре.

3. **Класс PopupWithCartUI**  
Дочерний класс от Modal.
Отображает элементы товара в полном объеме( интерфейс IProductCard) + кнопку "Купить".
Если цена null, то Кнопка "Купить" не активна. 
При клике на кнопку "Купить" генерируется событие  ui:add-card, Текст кнопки меняется на "Удалить из корзины" и обновляется цифра на иконке корзины.
При клике на кнопку "Удалить из корзины" генерируется событие  ui:delete-card, Текст кнопки меняется на "Купить" и обновляется цифра на иконке корзины.

4. **Класс PopupDeliveryUI**  
Дочерний класс от Modal.
Отображает элементы корзины: список товаров(название и цена), иконка удаления корзины у каждого товара, кнопка Оформить и итоговая цена заказа.
Если товаров в корзине нет, то отображается текст "Вы еще не добавили ни одного товара", кнопка Оформить не активна, общая цена 0.
При клике на иконку удаления корзины генерируется событие ui:delete-cart, товар удаляется из корзины и обновляется цифра на иконке корзины.
При клике на кнопку "Оформить" генерируется событие  ui:create-order, модальное окно закрывается и открывается первое окно оформления товара. 

5. **Класс PopupContactsUI**  
Дочерний класс от Modal.
Отображает элементы формы при оформлении заказа. 
Содержит кнопку Далее или Оформить(изначально не активные).
Когда все обязательные поля формы заполнены и прошли валидацию, то кнопки становятся активными. 
При нажатии на кнопку "Далее" генерируется событие ui:open-popupOrder, закрывается текущее модальное окно закрывается и открывается следующий шаг
При нажатии на кнопку "Оформить" генерируется событие ui:send-order, закрывается текущее модальное окно закрывается. В случае успешной отправки появляется Модально Окно PopupWithSuccessStatus c номером заказа и сообщением о статусе оформления заказа

6. **Класс PopupOrderStatusUI**  
Дочерний класс от Modal.
Отображает текст со статусом заказа.



## Размещение в сети
Рабочая версия игры доступна по адресу: ****

